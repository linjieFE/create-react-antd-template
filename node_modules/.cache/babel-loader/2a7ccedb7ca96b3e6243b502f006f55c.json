{"ast":null,"code":"import \"antd/es/back-top/style/css\";\nimport _BackTop from \"antd/es/back-top\";\nimport \"antd/es/message/style/css\";\nimport _message from \"antd/es/message\";\nimport \"antd/es/layout/style/css\";\nimport _Layout from \"antd/es/layout\";\nvar _jsxFileName = \"/Users/flexiv/Downloads/react-admin-master/src/containers/DefaultLayout.jsx\";\nimport React, { Component } from 'react';\nimport { Route, Switch, Redirect, withRouter } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport routes from '../routes';\nimport { menuToggleAction } from '../store/actionCreators';\nimport echarts from 'echarts/lib/echarts';\nimport avatar from '../assets/images/user.jpg';\nimport menu from './menu';\nimport '../style/layout.scss';\nimport AppHeader from './AppHeader.jsx';\nimport AppAside from './AppAside.jsx';\nimport AppFooter from './AppFooter.jsx';\nconst Content = _Layout.Content;\n\nclass DefaultLayout extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      avatar,\n      show: true,\n      menu: []\n    };\n\n    this.isLogin = () => {\n      if (!localStorage.getItem('user')) {\n        this.props.history.push('/login');\n      }\n    };\n\n    this.loginOut = () => {\n      localStorage.clear();\n      this.props.history.push('/login');\n\n      _message.success('登出成功!');\n    };\n\n    this.getMenu = menu => {\n      let newMenu,\n          auth = JSON.parse(localStorage.getItem('user')).auth;\n\n      if (!auth) {\n        return menu;\n      } else {\n        newMenu = menu.filter(res => res.auth && res.auth.indexOf(auth) !== -1);\n        return newMenu;\n      }\n    };\n  }\n\n  componentDidMount() {\n    if (localStorage.getItem('user')) {\n      this.setState({\n        menu: this.getMenu(menu)\n      });\n    }\n\n    this.isLogin();\n  }\n\n  componentDidUpdate() {\n    let pathname = this.props.location.pathname; // 菜单收缩展开时 echarts 图表的自适应\n\n    if (pathname === '/' || pathname === '/index') {\n      this.timer = setTimeout(() => {\n        echarts.init(document.getElementById('bar')).resize();\n        echarts.init(document.getElementById('line')).resize();\n        echarts.init(document.getElementById('pie')).resize();\n        echarts.init(document.getElementById('pictorialBar')).resize();\n        echarts.init(document.getElementById('scatter')).resize();\n      }, 500);\n    } else {\n      this.timer = null;\n    }\n  }\n\n  componentWillUnmount() {\n    this.timer && clearTimeout(this.timer);\n  }\n\n  render() {\n    let _this$props = this.props,\n        menuClick = _this$props.menuClick,\n        menuToggle = _this$props.menuToggle;\n\n    let _ref = JSON.parse(localStorage.getItem('user')) ? JSON.parse(localStorage.getItem('user')) : '',\n        auth = _ref.auth;\n\n    return React.createElement(_Layout, {\n      className: \"app\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    }, React.createElement(_BackTop, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    }), React.createElement(AppAside, {\n      menuToggle: menuToggle,\n      menu: this.state.menu,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }), React.createElement(_Layout, {\n      style: {\n        marginLeft: menuToggle ? '80px' : '200px',\n        minHeight: '100vh'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, React.createElement(AppHeader, {\n      menuToggle: menuToggle,\n      menuClick: menuClick,\n      avatar: this.state.avatar,\n      show: this.state.show,\n      loginOut: this.loginOut,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }), React.createElement(Content, {\n      className: \"content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, React.createElement(Switch, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }, routes.map(item => {\n      return React.createElement(Route, {\n        key: item.path,\n        path: item.path,\n        exact: item.exact,\n        render: props => !auth ? React.createElement(item.component, Object.assign({}, props, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 102\n          },\n          __self: this\n        })) : item.auth && item.auth.indexOf(auth) !== -1 ? React.createElement(item.component, Object.assign({}, props, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 104\n          },\n          __self: this\n        })) : // 这里也可以跳转到 403 页面\n        React.createElement(Redirect, Object.assign({\n          to: \"/404\"\n        }, props, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 107\n          },\n          __self: this\n        })),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      });\n    }), React.createElement(Redirect, {\n      to: \"/404\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }))), React.createElement(AppFooter, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    })));\n  }\n\n}\n\nconst stateToProp = state => ({\n  menuToggle: state.menuToggle\n});\n\nconst dispatchToProp = dispatch => ({\n  menuClick() {\n    dispatch(menuToggleAction());\n  }\n\n});\n\nexport default withRouter(connect(stateToProp, dispatchToProp)(DefaultLayout));","map":{"version":3,"sources":["/Users/flexiv/Downloads/react-admin-master/src/containers/DefaultLayout.jsx"],"names":["React","Component","Route","Switch","Redirect","withRouter","connect","routes","menuToggleAction","echarts","avatar","menu","AppHeader","AppAside","AppFooter","Content","DefaultLayout","state","show","isLogin","localStorage","getItem","props","history","push","loginOut","clear","success","getMenu","newMenu","auth","JSON","parse","filter","res","indexOf","componentDidMount","setState","componentDidUpdate","pathname","location","timer","setTimeout","init","document","getElementById","resize","componentWillUnmount","clearTimeout","render","menuClick","menuToggle","marginLeft","minHeight","map","item","path","exact","stateToProp","dispatchToProp","dispatch"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { Route, Switch, Redirect, withRouter } from 'react-router-dom'\nimport { connect } from 'react-redux'\nimport { Layout, BackTop, message } from 'antd'\nimport routes from '../routes'\nimport { menuToggleAction } from '../store/actionCreators'\nimport echarts from 'echarts/lib/echarts'\nimport avatar from '../assets/images/user.jpg'\nimport menu from './menu'\nimport '../style/layout.scss'\n\nimport AppHeader from './AppHeader.jsx'\nimport AppAside from './AppAside.jsx'\nimport AppFooter from './AppFooter.jsx'\n\nconst { Content } = Layout\n\nclass DefaultLayout extends Component {\n    state = {\n        avatar,\n        show: true,\n        menu: []\n    }\n\n    isLogin = () => {\n        if (!localStorage.getItem('user')) {\n            this.props.history.push('/login')\n        }\n    }\n\n    loginOut = () => {\n        localStorage.clear()\n        this.props.history.push('/login')\n        message.success('登出成功!')\n    }\n    getMenu = menu => {\n        let newMenu,\n            auth = JSON.parse(localStorage.getItem('user')).auth\n        if (!auth) {\n            return menu\n        } else {\n            newMenu = menu.filter(res => res.auth && res.auth.indexOf(auth) !== -1)\n            return newMenu\n        }\n    }\n\n    componentDidMount() {\n        if(localStorage.getItem('user')){\n            this.setState({\n                menu: this.getMenu(menu)\n            })\n        }\n        this.isLogin()\n    }\n\n    componentDidUpdate() {\n        let { pathname } = this.props.location\n\n        // 菜单收缩展开时 echarts 图表的自适应\n        if (pathname === '/' || pathname === '/index') {\n            this.timer = setTimeout(() => {\n                echarts.init(document.getElementById('bar')).resize()\n                echarts.init(document.getElementById('line')).resize()\n                echarts.init(document.getElementById('pie')).resize()\n                echarts.init(document.getElementById('pictorialBar')).resize()\n                echarts.init(document.getElementById('scatter')).resize()\n            }, 500)\n        } else {\n            this.timer = null\n        }\n    }\n\n    componentWillUnmount() {\n        this.timer && clearTimeout(this.timer)\n    }\n\n    render() {\n        let { menuClick, menuToggle } = this.props\n        let { auth } = JSON.parse(localStorage.getItem('user')) ? JSON.parse(localStorage.getItem('user')) : ''\n        return (\n            <Layout className='app'>\n                <BackTop />\n                <AppAside menuToggle={menuToggle} menu={this.state.menu} />\n                <Layout style={{ marginLeft: menuToggle ? '80px' : '200px', minHeight: '100vh' }}>\n                    <AppHeader\n                        menuToggle={menuToggle}\n                        menuClick={menuClick}\n                        avatar={this.state.avatar}\n                        show={this.state.show}\n                        loginOut={this.loginOut}\n                    />\n                    <Content className='content'>\n                        <Switch>\n                            {routes.map(item => {\n                                return (\n                                    <Route\n                                        key={item.path}\n                                        path={item.path}\n                                        exact={item.exact}\n                                        render={props =>\n                                            !auth ? (\n                                                <item.component {...props} />\n                                            ) : item.auth && item.auth.indexOf(auth) !== -1 ? (\n                                                <item.component {...props} />\n                                            ) : (\n                                                // 这里也可以跳转到 403 页面\n                                                <Redirect to='/404' {...props} />\n                                            )\n                                        }></Route>\n                                )\n                            })}\n                            <Redirect to='/404' />\n                        </Switch>\n                    </Content>\n                    <AppFooter />\n                </Layout>\n            </Layout>\n        )\n    }\n}\n\nconst stateToProp = state => ({\n    menuToggle: state.menuToggle\n})\n\nconst dispatchToProp = dispatch => ({\n    menuClick() {\n        dispatch(menuToggleAction())\n    }\n})\n\nexport default withRouter(\n    connect(\n        stateToProp,\n        dispatchToProp\n    )(DefaultLayout)\n)\n"]},"metadata":{},"sourceType":"module"}