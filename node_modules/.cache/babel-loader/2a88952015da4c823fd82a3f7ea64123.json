{"ast":null,"code":"import \"antd/es/pagination/style\";\nimport _Pagination from \"antd/es/pagination\";\nimport \"antd/es/divider/style\";\nimport _Divider from \"antd/es/divider\";\nimport \"antd/es/tag/style\";\nimport _Tag from \"antd/es/tag\";\nimport \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/select/style\";\nimport _Select from \"antd/es/select\";\nimport \"antd/es/form/style\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/input/style\";\nimport _Input from \"antd/es/input\";\nimport \"antd/es/message/style\";\nimport _message from \"antd/es/message\";\nimport \"antd/es/collapse/style\";\nimport _Collapse from \"antd/es/collapse\";\nimport \"antd/es/table/style\";\nimport _Table from \"antd/es/table\";\nvar _jsxFileName = \"/Users/flexiv/Downloads/react-antd-admin-template-master/src/views/table/index.jsx\";\nimport React, { Component } from \"react\";\nimport { tableList, deleteItem, editItem } from \"@/api/table\";\nimport EditForm from \"./forms/editForm\";\nconst {\n  Column\n} = _Table;\nconst {\n  Panel\n} = _Collapse;\n\nclass TableComponent extends Component {\n  constructor(...args) {\n    super(...args);\n    this._isMounted = false;\n    this.state = {\n      list: [],\n      loading: false,\n      total: 0,\n      listQuery: {\n        pageNumber: 1,\n        pageSize: 10,\n        title: \"\",\n        star: \"\",\n        status: \"\"\n      },\n      editModalVisible: false,\n      editModalLoading: false,\n      currentRowData: {\n        id: 0,\n        author: \"\",\n        date: \"\",\n        readings: 0,\n        star: \"★\",\n        status: \"published\",\n        title: \"\"\n      }\n    };\n\n    this.fetchData = () => {\n      this.setState({\n        loading: true\n      });\n      tableList(this.state.listQuery).then(response => {\n        this.setState({\n          loading: false\n        });\n        const list = response.data.data.items;\n        const total = response.data.data.total;\n\n        if (this._isMounted) {\n          this.setState({\n            list,\n            total\n          });\n        }\n      });\n    };\n\n    this.filterTitleChange = e => {\n      let value = e.target.value;\n      this.setState(state => ({\n        listQuery: { ...state.listQuery,\n          title: value\n        }\n      }));\n    };\n\n    this.filterStatusChange = value => {\n      this.setState(state => ({\n        listQuery: { ...state.listQuery,\n          status: value\n        }\n      }));\n    };\n\n    this.filterStarChange = value => {\n      this.setState(state => ({\n        listQuery: { ...state.listQuery,\n          star: value\n        }\n      }));\n    };\n\n    this.changePage = (pageNumber, pageSize) => {\n      this.setState(state => ({\n        listQuery: { ...state.listQuery,\n          pageNumber\n        }\n      }), () => {\n        this.fetchData();\n      });\n    };\n\n    this.changePageSize = (current, pageSize) => {\n      this.setState(state => ({\n        listQuery: { ...state.listQuery,\n          pageNumber: 1,\n          pageSize\n        }\n      }), () => {\n        this.fetchData();\n      });\n    };\n\n    this.handleDelete = row => {\n      deleteItem({\n        id: row.id\n      }).then(res => {\n        _message.success(\"删除成功\");\n\n        this.fetchData();\n      });\n    };\n\n    this.handleEdit = row => {\n      this.setState({\n        currentRowData: Object.assign({}, row),\n        editModalVisible: true\n      });\n    };\n\n    this.handleOk = _ => {\n      const {\n        form\n      } = this.formRef.props;\n      form.validateFields((err, fieldsValue) => {\n        if (err) {\n          return;\n        }\n\n        const values = { ...fieldsValue,\n          'star': \"\".padStart(fieldsValue['star'], '★'),\n          'date': fieldsValue['date'].format('YYYY-MM-DD HH:mm:ss')\n        };\n        this.setState({\n          editModalLoading: true\n        });\n        editItem(values).then(response => {\n          form.resetFields();\n          this.setState({\n            editModalVisible: false,\n            editModalLoading: false\n          });\n\n          _message.success(\"编辑成功!\");\n\n          this.fetchData();\n        }).catch(e => {\n          _message.success(\"编辑失败,请重试!\");\n        });\n      });\n    };\n\n    this.handleCancel = _ => {\n      this.setState({\n        editModalVisible: false\n      });\n    };\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n    this.fetchData();\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"app-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(_Collapse, {\n      defaultActiveKey: [\"1\"],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Panel, {\n      header: \"\\u7B5B\\u9009\",\n      key: \"1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(_Form, {\n      layout: \"inline\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(_Form.Item, {\n      label: \"\\u6807\\u9898:\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(_Input, {\n      onChange: this.filterTitleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(_Form.Item, {\n      label: \"\\u7C7B\\u578B:\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(_Select, {\n      style: {\n        width: 120\n      },\n      onChange: this.filterStatusChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(_Select.Option, {\n      value: \"published\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 19\n      }\n    }, \"published\"), /*#__PURE__*/React.createElement(_Select.Option, {\n      value: \"draft\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 19\n      }\n    }, \"draft\"))), /*#__PURE__*/React.createElement(_Form.Item, {\n      label: \"\\u63A8\\u8350\\u6307\\u6570:\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(_Select, {\n      style: {\n        width: 120\n      },\n      onChange: this.filterStarChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(_Select.Option, {\n      value: 1,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 19\n      }\n    }, \"\\u2605\"), /*#__PURE__*/React.createElement(_Select.Option, {\n      value: 2,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 19\n      }\n    }, \"\\u2605\\u2605\"), /*#__PURE__*/React.createElement(_Select.Option, {\n      value: 3,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 19\n      }\n    }, \"\\u2605\\u2605\\u2605\"))), /*#__PURE__*/React.createElement(_Form.Item, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(_Button, {\n      type: \"primary\",\n      icon: \"search\",\n      onClick: this.fetchData,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 17\n      }\n    }, \"\\u641C\\u7D22\"))))), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(_Table, {\n      bordered: true,\n      rowKey: record => record.id,\n      dataSource: this.state.list,\n      loading: this.state.loading,\n      pagination: false,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Column, {\n      title: \"\\u5E8F\\u53F7\",\n      dataIndex: \"id\",\n      key: \"id\",\n      width: 200,\n      align: \"center\",\n      sorter: (a, b) => a.id - b.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Column, {\n      title: \"\\u6807\\u9898\",\n      dataIndex: \"title\",\n      key: \"title\",\n      width: 200,\n      align: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Column, {\n      title: \"\\u4F5C\\u8005\",\n      dataIndex: \"author\",\n      key: \"author\",\n      width: 100,\n      align: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Column, {\n      title: \"\\u9605\\u8BFB\\u91CF\",\n      dataIndex: \"readings\",\n      key: \"readings\",\n      width: 195,\n      align: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Column, {\n      title: \"\\u63A8\\u8350\\u6307\\u6570\",\n      dataIndex: \"star\",\n      key: \"star\",\n      width: 195,\n      align: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Column, {\n      title: \"\\u72B6\\u6001\",\n      dataIndex: \"status\",\n      key: \"status\",\n      width: 195,\n      align: \"center\",\n      render: status => {\n        let color = status === \"published\" ? \"green\" : status === \"deleted\" ? \"red\" : \"\";\n        return /*#__PURE__*/React.createElement(_Tag, {\n          color: color,\n          key: status,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 15\n          }\n        }, status);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Column, {\n      title: \"\\u65F6\\u95F4\",\n      dataIndex: \"date\",\n      key: \"date\",\n      width: 195,\n      align: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Column, {\n      title: \"\\u64CD\\u4F5C\",\n      key: \"action\",\n      width: 195,\n      align: \"center\",\n      render: (text, row) => /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        shape: \"circle\",\n        icon: \"edit\",\n        title: \"\\u7F16\\u8F91\",\n        onClick: this.handleEdit.bind(null, row),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(_Divider, {\n        type: \"vertical\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        shape: \"circle\",\n        icon: \"delete\",\n        title: \"\\u5220\\u9664\",\n        onClick: this.handleDelete.bind(null, row),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 15\n        }\n      })),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(_Pagination, {\n      total: this.state.total,\n      pageSizeOptions: [\"10\", \"20\", \"40\"],\n      showTotal: total => `共${total}条数据`,\n      onChange: this.changePage,\n      current: this.state.listQuery.pageNumber,\n      onShowSizeChange: this.changePageSize,\n      showSizeChanger: true,\n      showQuickJumper: true,\n      hideOnSinglePage: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(EditForm, {\n      currentRowData: this.state.currentRowData,\n      wrappedComponentRef: formRef => this.formRef = formRef,\n      visible: this.state.editModalVisible,\n      confirmLoading: this.state.editModalLoading,\n      onCancel: this.handleCancel,\n      onOk: this.handleOk,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\nexport default TableComponent;","map":{"version":3,"sources":["/Users/flexiv/Downloads/react-antd-admin-template-master/src/views/table/index.jsx"],"names":["React","Component","tableList","deleteItem","editItem","EditForm","Column","Panel","TableComponent","_isMounted","state","list","loading","total","listQuery","pageNumber","pageSize","title","star","status","editModalVisible","editModalLoading","currentRowData","id","author","date","readings","fetchData","setState","then","response","data","items","filterTitleChange","e","value","target","filterStatusChange","filterStarChange","changePage","changePageSize","current","handleDelete","row","res","success","handleEdit","Object","assign","handleOk","_","form","formRef","props","validateFields","err","fieldsValue","values","padStart","format","resetFields","catch","handleCancel","componentDidMount","componentWillUnmount","render","width","record","a","b","color","text","bind"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport {\n  Table,\n  Tag,\n  Form,\n  Button,\n  Input,\n  Collapse,\n  Pagination,\n  Divider,\n  message,\n  Select\n} from \"antd\";\nimport { tableList, deleteItem,editItem } from \"@/api/table\";\nimport EditForm from \"./forms/editForm\"\nconst { Column } = Table;\nconst { Panel } = Collapse;\nclass TableComponent extends Component {\n  _isMounted = false; // 这个变量是用来标志当前组件是否挂载\n  state = {\n    list: [],\n    loading: false,\n    total: 0,\n    listQuery: {\n      pageNumber: 1,\n      pageSize: 10,\n      title: \"\",\n      star: \"\",\n      status:\"\"\n    },\n    editModalVisible: false,\n    editModalLoading: false,\n    currentRowData: {\n      id: 0,\n      author: \"\",\n      date: \"\",\n      readings: 0,\n      star: \"★\",\n      status: \"published\",\n      title: \"\"\n    }\n  };\n  fetchData = () => {\n    this.setState({ loading: true });\n    tableList(this.state.listQuery).then((response) => {\n      this.setState({ loading: false });\n      const list = response.data.data.items;\n      const total = response.data.data.total;\n      if (this._isMounted) {\n        this.setState({ list, total });\n      }\n    });\n  };\n  componentDidMount() {\n    this._isMounted = true;\n    this.fetchData();\n  }\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n  filterTitleChange = (e) => {\n    let value = e.target.value\n    this.setState((state) => ({\n      listQuery: {\n        ...state.listQuery,\n        title:value,\n      }\n    }));\n  };\n  filterStatusChange = (value) => {\n    this.setState((state) => ({\n      listQuery: {\n        ...state.listQuery,\n        status:value,\n      }\n    }));\n  };\n  filterStarChange  = (value) => {\n    this.setState((state) => ({\n      listQuery: {\n        ...state.listQuery,\n        star:value,\n      }\n    }));\n  };\n  changePage = (pageNumber, pageSize) => {\n    this.setState(\n      (state) => ({\n        listQuery: {\n          ...state.listQuery,\n          pageNumber,\n        },\n      }),\n      () => {\n        this.fetchData();\n      }\n    );\n  };\n  changePageSize = (current, pageSize) => {\n    this.setState(\n      (state) => ({\n        listQuery: {\n          ...state.listQuery,\n          pageNumber: 1,\n          pageSize,\n        },\n      }),\n      () => {\n        this.fetchData();\n      }\n    );\n  };\n  handleDelete = (row) => {\n    deleteItem({id:row.id}).then(res => {\n      message.success(\"删除成功\")\n      this.fetchData();\n    })\n  }\n  handleEdit = (row) => {\n    this.setState({\n      currentRowData:Object.assign({}, row),\n      editModalVisible: true,\n    });\n  };\n\n  handleOk = _ => {\n    const { form } = this.formRef.props;\n    form.validateFields((err, fieldsValue) => {\n      if (err) {\n        return;\n      }\n      const values = {\n        ...fieldsValue,\n        'star': \"\".padStart(fieldsValue['star'], '★'),\n        'date': fieldsValue['date'].format('YYYY-MM-DD HH:mm:ss'),\n      };\n      this.setState({ editModalLoading: true, });\n      editItem(values).then((response) => {\n        form.resetFields();\n        this.setState({ editModalVisible: false, editModalLoading: false });\n        message.success(\"编辑成功!\")\n        this.fetchData()\n      }).catch(e => {\n        message.success(\"编辑失败,请重试!\")\n      })\n      \n    });\n  };\n\n  handleCancel = _ => {\n    this.setState({\n      editModalVisible: false,\n    });\n  };\n  render() {\n    return (\n      <div className=\"app-container\">\n        <Collapse defaultActiveKey={[\"1\"]}>\n          <Panel header=\"筛选\" key=\"1\">\n            <Form layout=\"inline\">\n              <Form.Item label=\"标题:\">\n                <Input onChange={this.filterTitleChange} />\n              </Form.Item>\n              <Form.Item label=\"类型:\">\n                <Select\n                  style={{ width: 120 }}\n                  onChange={this.filterStatusChange}>\n                  <Select.Option value=\"published\">published</Select.Option>\n                  <Select.Option value=\"draft\">draft</Select.Option>\n                </Select>\n              </Form.Item>\n              <Form.Item label=\"推荐指数:\">\n                <Select\n                  style={{ width: 120 }}\n                  onChange={this.filterStarChange}>\n                  <Select.Option value={1}>★</Select.Option>\n                  <Select.Option value={2}>★★</Select.Option>\n                  <Select.Option value={3}>★★★</Select.Option>\n                </Select>\n              </Form.Item>\n              <Form.Item>\n                <Button type=\"primary\" icon=\"search\" onClick={this.fetchData}>\n                  搜索\n                </Button>\n              </Form.Item>\n            </Form>\n          </Panel>\n        </Collapse>\n        <br />\n        <Table\n          bordered\n          rowKey={(record) => record.id}\n          dataSource={this.state.list}\n          loading={this.state.loading}\n          pagination={false}\n        >\n          <Column title=\"序号\" dataIndex=\"id\" key=\"id\" width={200} align=\"center\" sorter={(a, b) => a.id - b.id}/>\n          <Column title=\"标题\" dataIndex=\"title\" key=\"title\" width={200} align=\"center\"/>\n          <Column title=\"作者\" dataIndex=\"author\" key=\"author\" width={100} align=\"center\"/>\n          <Column title=\"阅读量\" dataIndex=\"readings\" key=\"readings\" width={195} align=\"center\"/>\n          <Column title=\"推荐指数\" dataIndex=\"star\" key=\"star\" width={195} align=\"center\"/>\n          <Column title=\"状态\" dataIndex=\"status\" key=\"status\" width={195} align=\"center\" render={(status) => {\n            let color =\n              status === \"published\" ? \"green\" : status === \"deleted\" ? \"red\" : \"\";\n            return (\n              <Tag color={color} key={status}>\n                {status}\n              </Tag>\n            );\n          }}/>\n          <Column title=\"时间\" dataIndex=\"date\" key=\"date\" width={195} align=\"center\"/>\n          <Column title=\"操作\" key=\"action\" width={195} align=\"center\"render={(text, row) => (\n            <span>\n              <Button type=\"primary\" shape=\"circle\" icon=\"edit\" title=\"编辑\" onClick={this.handleEdit.bind(null,row)}/>\n              <Divider type=\"vertical\" />\n              <Button type=\"primary\" shape=\"circle\" icon=\"delete\" title=\"删除\" onClick={this.handleDelete.bind(null,row)}/>\n            </span>\n          )}/>\n        </Table>\n        <br />\n        <Pagination\n          total={this.state.total}\n          pageSizeOptions={[\"10\", \"20\", \"40\"]}\n          showTotal={(total) => `共${total}条数据`}\n          onChange={this.changePage}\n          current={this.state.listQuery.pageNumber}\n          onShowSizeChange={this.changePageSize}\n          showSizeChanger\n          showQuickJumper\n          hideOnSinglePage={true}\n        />\n        <EditForm\n          currentRowData={this.state.currentRowData}\n          wrappedComponentRef={formRef => this.formRef = formRef}\n          visible={this.state.editModalVisible}\n          confirmLoading={this.state.editModalLoading}\n          onCancel={this.handleCancel}\n          onOk={this.handleOk}\n        />  \n      </div>\n    );\n  }\n}\n\nexport default TableComponent;\n"]},"metadata":{},"sourceType":"module"}